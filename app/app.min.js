function SportListController(a,b){function c(){a.getSports().then(function(a){for(var c="",d=0;d<a.count;d++)c+=d+1<a.count?a.rows[d].name+", ":a.rows[d].name;return b.setIndexes(a),c.split(/, +/g).map(function(a){var b={value:a.toLowerCase(),display:a};return f.sports.push(b)})})}function d(a){var b=a?f.sports.filter(e(a)):f.sports;return b}function e(a){var b=angular.lowercase(a);return function(a){return 0===a.value.indexOf(b)}}var f=this;f.loadAll=c,f.querySearch=d,f.selectedItem=null,f.searchText=null,f.sports=[],c()}function sportListService(a,b){function c(){function a(a){return a.Sports}function b(a){console.log(a)}return f.get({limit:100}).$promise.then(a)["catch"](b)}var d="https://localhost:3000/api",e=d,f=a(e+"/sports/:id",{id:"@id"},{query:{isArray:!1,method:"GET"}}),g={getSports:c};return g}function scrollTo(){function a(a,b,c){var d=$("#scroll");b.on("click",function(){$("body").animate({scrollTop:d.offset().top},"slow")})}var b={link:a,restrict:"A"};return b}function filteredResults(){var a={templateUrl:"app/home/est-results.html",restrict:"E"};return a}function establishmentFilteredService(a){function b(a,b,c){function d(a){return a}function e(a){return a.data.message}return"none"===c&&(c=void 0),h.get({id:a,location:b,after:c}).$promise.then(d)["catch"](e)}function c(a){return e.get(a)}function d(a){for(var b=0;b<a.rows.length;b++)e.set(a.rows[b].name,a.rows[b].id)}var e=new Map,f="https://localhost:3000/api",g=f,h=a(g+"/establishments/sport/:id/location/:location",{id:"@id",location:"@location"},{query:{isArray:!1,method:"GET"}}),i={getEstablishments:b,getIndexOf:c,setIndexes:d};return i}function citySuggestionsService(a){function b(b){return a.get(d+"/establishments/"+b+"/suggestions").then(function(a){return a.data.locations})}var c="https://localhost:3000/api",d=c,e={getCities:b};return e}function HomeController(a,b){function c(b){return a.getCities(b).then(function(a){return a})}var d=this;d.querySearch=c}function EstablishmentFilteredController(a,b,c){function d(b){h.activated=!1,h.prevLocation==h.location&&h.prevSport==h.sport||(h.items=[],h.after="none"),a.getEstablishments(h.sport,h.location,h.after).then(angular.bind(this,function(a){"There no more rows to retrieve"===a?h.activated=!0:"There are no establishments that match the current filter"===a?(h.activated=!0,c.show(c.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("¡Sin resultados!").textContent("No se han encontrado establecimientos para la búsqueda introducida.").ariaLabel("Alert Dialog Demo").ok("Listo").targetEvent(b))):(h.activated=!0,h.after=a.paging.cursors.after,h.items=h.items.concat(a.Establishments.rows),h.prevLocation=h.location,h.prevSport=h.sport)}))}function e(b){void 0!==b&&(h.sport=a.getIndexOf(b.display))}function f(a){void 0!==a&&(h.location=a)}function g(a){var b=a;return a.length>200&&(b=a.slice(0,200),b+="."!=b[199]?"...":".."),b}var h=this,i="https://localhost:3000/",j=i;h.activated=!0,h.after="none",h.fetchMore=d,h.imgFolder=j+"public/images/ests/",h.items=[],h.location=null,h.prevLocation=null,h.prevSport=null,h.selectedItemChange=e,h.selectedLocationChange=f,h.shortenDesc=g,h.sport=null}function loginService(a){function b(b,c){function e(a){return a.data}function g(a){return a.data}var h={username:b,password:c,grant_type:"password",client_id:d};return a.post(f+"/oauth2/token",h).then(e)["catch"](g)}function c(){return void 0!==localStorage.username}var d="2xa001za-78b3-4f38-9376-e2dd88b7c682",e="https://localhost:3000/api",f=e,g={getToken:b,isLoggedIn:c};return g}function LoginController(a,b,c,d){function e(){return!(localStorage.expires<=Date.now())}function f(){if(a.isLoggedIn()){j.loggedIn=!0,j.name=localStorage.username,j.role=localStorage.role;var b=d.absUrl(),c=d.protocol()+"://"+d.host()+":"+d.port()+"/"+d.path(),e=b.split(c);i(e[1])}}function g(d,e,f,g){a.getToken(d,e).then(function(a){a.error?b.show(b.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Login incorrecto").textContent("El email o la contraseña introducidos, no son correctos.").ariaLabel("Alert Dialog Demo").ok("Listo").targetEvent(g)):(f&&(localStorage.setItem("remember",!0),localStorage.setItem("password",e),localStorage.setItem("email",d)),localStorage.setItem("token",a.access_token),localStorage.setItem("username",a.username),localStorage.setItem("role",a.role),localStorage.setItem("user_id",a.user_id),localStorage.setItem("expires",a.expires),j.loggedIn=!0,j.name=a.username,j.role=a.role,c.location.href=k)})}function h(){j.loggedIn=!1,j.name=null,j.role=null,localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("role"),localStorage.removeItem("user_id"),localStorage.removeItem("expires"),localStorage.removeItem("password"),localStorage.removeItem("email")}function i(a){"login"===a&&(c.location.href=k)}var j=this,k=d.protocol()+"://"+d.host()+":"+d.port()+"/";j.checkToken=e,j.isLoggedIn=f,j.loggedIn=!1,j.login=g,j.logout=h,j.name=null,j.redirect=i,j.role=null,f()}function testApp(a){var b="https://localhost:3000/api",c={locations:["Alicante"]},d={locations:["Valencia"]};a.whenGET(b+"/establishments/Valencia/suggestions").respond(d),a.whenGET(b+"/establishments/Alicante/suggestions").respond(c)}function sportTest(a){var b="https://localhost:3000/api",c={rows:[{id:1,name:"Spinning"},{id:2,name:"GAP"},{id:3,name:"BodyJump"},{id:4,name:"Pilates"},{id:5,name:"CrossFit"}],count:5},d={Sports:c};a.whenGET(b+"/sports?limit=100").respond(d)}function estabsFilteredTest(a){var b="https://localhost:3000/api",c={message:"There are no establishments that match the current filter"};a.whenGET(b+"/establishments/sport/1/location/Valencia").respond(404,c);var d={id:1,name:"Gym A Tope",desc:"Gimnasio perfecto para realizar tus actividades deportivas.",city:"San Vicente del Raspeig",province:"Alicante",addr:"Calle San Franciso nº15",phone:"965660327",website:"http://wwww.gymatope.es",main_img:"default.jpg"},e={id:2,name:"Gym Noray",desc:"Gimnasio muy acondicionado y en perfecto estado.",city:"Santa Pola",province:"Alicante",addr:"Calle Falsa nº34",phone:"965662347",website:"http://wwww.noraygym.com",main_img:"default.jpg"},f={id:4,name:"Montemar",desc:"Especializados en cursos y clases de ténis.",city:"Alicante",province:"Alicante",addr:"Avenida Novelda Km 14",phone:"965662268",website:"http://wwww.montemar.es",main_img:"default.jpg"},g={count:3,rows:[d,e,f]},h={before:0,after:0},i={cursors:h,previous:"none",next:"none"},j={Establishments:g,paging:i};a.whenGET(b+"/establishments/sport/1/location/Alicante").respond(j),a.whenGET("app/home/est-results.html").passThrough()}angular.module("sportModule",["ngResource"]),angular.module("sportModule").controller("SportListController",SportListController),SportListController.$inject=["sportListService","establishmentFilteredService"],angular.module("sportModule").factory("sportListService",sportListService),sportListService.$inject=["$resource"],angular.module("homeModule",[]),angular.module("homeModule").directive("scrollTo",scrollTo),angular.module("homeModule").directive("filteredResults",filteredResults),angular.module("homeModule").factory("establishmentFilteredService",establishmentFilteredService),establishmentFilteredService.$inject=["$resource"],angular.module("homeModule").factory("citySuggestionsService",citySuggestionsService),citySuggestionsService.$inject=["$http"],angular.module("homeModule").controller("HomeController",HomeController),HomeController.$inject=["citySuggestionsService","$http"],angular.module("homeModule").controller("EstablishmentFilteredController",EstablishmentFilteredController),EstablishmentFilteredController.$inject=["establishmentFilteredService","$mdToast","$mdDialog"],angular.module("loginModule",[]),angular.module("loginModule").factory("loginService",loginService),loginService.$inject=["$http"],angular.module("loginModule").controller("LoginController",LoginController),LoginController.$inject=["loginService","$mdDialog","$window","$location"],function(){"use strict";angular.module("justSport",["ngMaterial","ngMessages","homeModule","sportModule","loginModule"]).config(["$mdThemingProvider",function(a){var b={50:"#65acf3",100:"#4d9ff1",200:"#3692ef",300:"#1e85ed",400:"#1279e0",500:"#106CC8",600:"#0e5fb0",700:"#0c5299",800:"#0a4681",900:"#08396a",A100:"#7cb8f5",A200:"#94c5f6",A400:"#acd2f8",A700:"#072c52",contrastDefaultColor:"light"};a.definePalette("customPrimary",b),a.theme("default").primaryPalette("customPrimary").accentPalette("orange")}])}(),function(){"use strict";function a(a){a.whenGET("./public/images/icons/account.svg").passThrough(),a.whenGET("public/images/icons/ic_expand_more_black_36px.svg").passThrough(),a.whenGET("public/images/icons/date.svg").passThrough(),a.whenGET("public/images/icons/info.svg").passThrough()}angular.module("justSportTest",["justSport","ngMockE2E"]).run(a),a.$inject=["$httpBackend"]}(),angular.module("justSportTest").run(testApp),testApp.$inject=["$httpBackend"],angular.module("justSportTest").run(sportTest),sportTest.$inject=["$httpBackend"],angular.module("justSportTest").run(estabsFilteredTest),estabsFilteredTest.$inject=["$httpBackend"];